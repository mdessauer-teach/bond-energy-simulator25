<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bond Energy Simulator — No Build</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Ubuntu, Cantarell, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
  </style>
</head>
<body class="bg-slate-50 text-slate-900">
  <div id="root"></div>

  <!-- React + ReactDOM UMD -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

  <!-- Babel for in-browser JSX transform -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Recharts UMD -->
  <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>

  <script type="text/babel">
    const { useState, useMemo } = React;
    const { ResponsiveContainer, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, Cell } = Recharts;

    const REACTANT_COLOR = "#0ea5e9"; // blue
    const PRODUCT_COLOR  = "#10b981"; // green

    const DEFAULT_BOND_ENERGIES = {
      "H-H": 436, "Cl-Cl": 243, "H-Cl": 431, "O=O": 498, "O-H": 463,
      "C-H": 413, "C-C": 348, "C=C": 614, "C=O": 799, "C-O": 358, "O-O": 146,
      "N≡N": 945, "N-H": 391,
    };

    const PRESETS = [
      { id: "hcl", name: "H2 + Cl2 → 2 HCl", description: "Synthesis of hydrogen chloride" },
      { id: "combustion", name: "CH4 + 2 O2 → CO2 + 2 H2O", description: "Combustion of methane" },
      { id: "haber", name: "N2 + 3 H2 → 2 NH3", description: "Haber process" },
      { id: "water_split", name: "2 H2O → 2 H2 + O2", description: "Electrolysis of water" },
      { id: "ethene_hydrogenation", name: "C2H4 + H2 → C2H6", description: "Hydrogenation of ethene" },
      { id: "ethanol_combustion", name: "C2H5OH + 3 O2 → 2 CO2 + 3 H2O", description: "Combustion of ethanol" },
      { id: "ozone_formation", name: "3 O2 → 2 O3", description: "Ozone formation (simplified)" },
    ];

    const clampInt = (n) => {
      const v = Number(n);
      return Number.isFinite(v) ? Math.max(0, Math.round(v)) : 0;
    };
    const uid = () => Math.random().toString(36).slice(2,8);

    function sumEnergy(counts, energies){
      let total = 0;
      for (const k of Object.keys(counts)){
        const c = Number(counts[k]) || 0;
        const e = Object.prototype.hasOwnProperty.call(energies, k) ? energies[k] : 0;
        total += c * (Number(e) || 0);
      }
      return total;
    }

    function classifyDeltaH(dH){
      if (dH < 0) return "exo";
      if (dH > 0) return "endo";
      return "neutral";
    }

    function A(id, element, x, y){ return { id, element, x, y }; }
    function B(a, b, key, order=1){ return { id: uid(), a, b, key, order }; }

    function buildModelsForPreset(presetId){
      if (!presetId) return { reactants: [], products: [] };
      const H2  = { name: "H2", atoms:[A("h1","H",30,40),A("h2","H",90,40)], bonds:[B("h1","h2","H-H",1)] };
      const Cl2 = { name: "Cl2", atoms:[A("c1","Cl",30,40),A("c2","Cl",90,40)], bonds:[B("c1","c2","Cl-Cl",1)] };
      const HCl = { name: "H-Cl",atoms:[A("h","H",30,40),A("cl","Cl",90,40)], bonds:[B("h","cl","H-Cl",1)] };
      const O2  = { name: "O2",  atoms:[A("o1","O",30,40),A("o2","O",90,40)], bonds:[B("o1","o2","O=O",2)] };
      const CO2 = { name: "CO2", atoms:[A("o1","O",20,40),A("c","C",60,40),A("o2","O",100,40)], bonds:[B("o1","c","C=O",2),B("c","o2","C=O",2)] };
      const H2O = { name: "H2O", atoms:[A("o","O",60,30),A("h1","H",25,60),A("h2","H",95,60)], bonds:[B("o","h1","O-H",1),B("o","h2","O-H",1)] };
      const CH4 = { name: "CH4", atoms:[A("c","C",60,40),A("h1","H",20,15),A("h2","H",20,65),A("h3","H",100,20),A("h4","H",100,60)], bonds:[B("c","h1","C-H",1),B("c","h2","C-H",1),B("c","h3","C-H",1),B("c","h4","C-H",1)] };
      const N2  = { name: "N2",  atoms:[A("n1","N",30,40),A("n2","N",90,40)], bonds:[B("n1","n2","N≡N",3)] };
      const NH3 = { name: "NH3", atoms:[A("n","N",60,40),A("h1","H",20,20),A("h2","H",20,60),A("h3","H",100,40)], bonds:[B("n","h1","N-H",1),B("n","h2","N-H",1),B("n","h3","N-H",1)] };

      switch (presetId){
        case "hcl": return { reactants:[H2,Cl2], products:[HCl,HCl] };
        case "combustion": return { reactants:[CH4,O2,O2], products:[CO2,H2O,H2O] };
        case "haber": return { reactants:[N2,H2,H2,H2], products:[NH3,NH3] };
        case "water_split": return { reactants:[H2O,H2O], products:[H2,O2] };
        default: return { reactants:[], products:[] };
      }
    }

    function Molecule({ model, onClickBond, themeColor }){
      return (
        <div className="bg-slate-50 rounded-xl p-2">
          <div className="text-xs font-medium mb-1" style={{ color: themeColor }}>{model.name}</div>
          <svg viewBox="0 0 120 80" className="w-full h-36">
            {model.bonds.map((b) => {
              const a = model.atoms.find(x => x.id===b.a);
              const c = model.atoms.find(x => x.id===b.b);
              return (
                <g key={b.id} className="cursor-pointer" onClick={(e)=>onClickBond(b.key, e.shiftKey)}>
                  <line x1={a.x} y1={a.y} x2={c.x} y2={c.y} stroke={themeColor} strokeWidth="3" strokeLinecap="round" />
                  <line x1={a.x} y1={a.y} x2={c.x} y2={c.y} stroke="transparent" strokeWidth="14" />
                </g>
              );
            })}
            {model.atoms.map(atom => (
              <g key={atom.id}>
                <circle cx={atom.x} cy={atom.y} r="7" fill="#fff" stroke={themeColor} strokeWidth="2"></circle>
                <text x={atom.x} y={atom.y+3} fontSize="9" textAnchor="middle" fill="#0f172a">{atom.element}</text>
              </g>
            ))}
          </svg>
        </div>
      );
    }

    function App(){
      const [bondEnergies] = useState({ ...DEFAULT_BOND_ENERGIES });
      const [reactantCounts, setReactantCounts] = useState({});
      const [productCounts, setProductCounts] = useState({});
      const [currentPresetId, setCurrentPresetId] = useState(null);

      const chartData = useMemo(()=>{
        return [
          { label:"Bonds Broken (Reactants)", energy:0, fill:REACTANT_COLOR },
          { label:"Bonds Formed (Products)",  energy:0, fill:PRODUCT_COLOR },
        ];
      },[]);

      function bump(side, key, delta){
        const setter = side==='r'? setReactantCounts : setProductCounts;
        const src = side==='r'? reactantCounts : productCounts;
        setter({ ...src, [key]: clampInt((src[key]||0) + delta) });
      }

      return (
        <div className="min-h-screen w-full p-6">
          <h1 className="text-2xl font-bold mb-4">Endo/Exothermic Bond Energy Simulator</h1>
          <div className="grid md:grid-cols-2 gap-6">
            <div>
              <h2 className="font-semibold mb-2">Reactions</h2>
              {PRESETS.map(p => (
                <button key={p.id} className={"block w-full text-left rounded-xl p-3 mb-2 " + (currentPresetId===p.id? "bg-blue-100":"bg-slate-100 hover:bg-slate-200")} onClick={()=>setCurrentPresetId(p.id)}>
                  <div className="font-medium">{p.name}</div>
                  <div className="text-xs text-slate-600">{p.description}</div>
                </button>
              ))}
            </div>
            <div>
              <h2 className="font-semibold mb-2">Models</h2>
              <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                {buildModelsForPreset(currentPresetId).reactants.map((m,i)=>
                  <Molecule key={"r"+i} model={m} onClickBond={(bondKey, subtract)=>bump('r', bondKey, subtract? -1 : +1)} themeColor={REACTANT_COLOR}/>
                )}
                {buildModelsForPreset(currentPresetId).products.map((m,i)=>
                  <Molecule key={"p"+i} model={m} onClickBond={(bondKey, subtract)=>bump('p', bondKey, subtract? -1 : +1)} themeColor={PRODUCT_COLOR}/>
                )}
              </div>
            </div>
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
  <script>
  console.log("Simulator file loaded!");
</script>

</body>
</html>

